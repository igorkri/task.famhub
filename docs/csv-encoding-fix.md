# Виправлення кодування при імпорті CSV

## Проблема
При імпорті CSV файлу з банку (формат Windows-1251) текст відображався з неправильним кодуванням:
```
Від: ÒÎÂ ²ÍÃÑÎÒ
Банк: ÀÒ ÓÊÐÑÈÁÁÀÍÊ
```

Замість:
```
Від: ТОВ ІНГРОТ
Банк: АТ УКРСИББАНК
```

## Рішення

### 1. Додано інтерфейс `WithCustomCsvSettings`
```php
use Maatwebsite\Excel\Concerns\WithCustomCsvSettings;

class ReceiptOfFundsCsvImport implements 
    SkipsEmptyRows, 
    ToCollection, 
    WithChunkReading, 
    WithCustomCsvSettings,  // <-- Додано
    WithValidation
{
    // ...
}
```

### 2. Реалізовано метод `getCsvSettings()`
```php
public function getCsvSettings(): array
{
    return [
        'input_encoding' => 'Windows-1251',  // Кодування вхідного файлу
        'delimiter' => ';',                   // Роздільник (крапка з комою)
        'enclosure' => '"',                   // Символ обрамлення
    ];
}
```

### 3. Виправлено формат поля `period`
```php
'period' => [
    'type' => 'month',
    'year' => $operationDate->year,
    'month' => $operationDate->format('F'),  // Назва місяця англійською (January, February, etc.)
],
```

### 4. Перекладено всі повідомлення на українську мову
- ❌ Помилки: "Помилка в рядку", "Невірна дата операції"
- ⚠️ Попередження: "Рядок містить недостатньо даних", "Запис вже існує"
- ✅ Валідаційні повідомлення: "Дата операції обов'язкова", "Сума має бути числом"

## Результат
Тепер при імпорті CSV файлу:
- ✅ Текст відображається коректно в кодуванні UTF-8
- ✅ Всі українські символи читаються правильно
- ✅ Роздільник `;` обробляється коректно
- ✅ Поле `period` має правильний формат JSON
- ✅ Всі повідомлення українською мовою

## Тестування
Для тестування імпорту можна використати файл через інтерфейс Filament у розділі "Акти виконаних робіт".

## Формат CSV файлу
- **Кодування**: Windows-1251
- **Роздільник**: `;` (крапка з комою)
- **Обрамлення**: `"` (подвійні лапки)
- **Заголовки**: Перша строка містить назви колонок

## Структура колонок
| Індекс | Назва | Опис |
|--------|----------|----------|
| 0 | ЄДРПОУ | Код ЄДРПОУ банку |
| 1 | Код ID НБУ | Код банку в НБУ |
| 2 | Рахунок | Номер рахунку |
| 3 | Валюта | Валюта операції (UAH) |
| 4 | Дата операції | Дата і час операції |
| 6 | Код ID НБУ надавача | Код банку отримувача |
| 7 | Надавач платіжних послуг | Назва банку отримувача |
| 8 | Рахунок кореспондента | Номер рахунку отримувача |
| 9 | ЄДРПОУ кореспондента | Код ЄДРПОУ отримувача |
| 10 | Кореспондент | Назва отримувача |
| 11 | Номер документа | Номер платіжного документа |
| 12 | Дата документа | Дата документа |
| 14 | Кредит | Сума надходження |
| 15 | Призначення платежу | Призначення платежу |
| 16 | Гривневе покриття | Дублікат суми |

## Формат збережених даних

### Поле `period`
Зберігається у форматі JSON:
```json
{
  "type": "month",
  "year": 2025,
  "month": "October"
}
```

### Поле `description`
Формується з полів:
- `Від:` - назва отримувача (поле 10)
- `Призначення:` - призначення платежу (поле 15)

Приклад:
```
Від: ТОВ ІНГРОТ. Призначення: За розробку веб-сайту Ksimex, пл. 3, згідно рахунка № 20 від 15.09.2025 р. без ПДВ
```

