# Візуальна схема Badge в навігації задач

## Як працює Badge

```
┌─────────────────────────────────────────┐
│  Бокова навігація Filament              │
├─────────────────────────────────────────┤
│                                         │
│  🏠 Головна                             │
│  📊 Dashboard                           │
│  👥 Користувачі                         │
│  📋 Задачі [12] 🔴                      │  <- Badge з кількістю задач
│  📁 Проєкти                             │
│  ⚙️  Налаштування                       │
│                                         │
└─────────────────────────────────────────┘
```

## Логіка підрахунку

```
┌─────────────────────────────────────────────────────────────┐
│                    База даних (tasks)                       │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │ Задача #1    │  │ Задача #2    │  │ Задача #3    │     │
│  │ status: new  │  │ status: prog │  │ status: done │     │
│  │ completed: 0 │  │ completed: 0 │  │ completed: 1 │     │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘     │
│         │                 │                 │              │
│         ✅ рахується      ✅ рахується      ❌ не рахується│
│                                                             │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │  Badge Count: 2  │
                    └──────────────────┘
                              │
                              ▼
                ┌──────────────────────────┐
                │  Визначення кольору:     │
                ├──────────────────────────┤
                │  0     → null (не показ) │
                │  1-4   → 🟢 success      │
                │  5-9   → 🟡 warning      │
                │  10+   → 🔴 danger       │
                └──────────────────────────┘
```

## Потік виконання

```
Користувач відкриває панель
           │
           ▼
┌────────────────────────┐
│ Filament завантажує    │
│ навігацію              │
└──────────┬─────────────┘
           │
           ▼
┌────────────────────────────────────┐
│ TaskResource::getNavigationBadge() │
├────────────────────────────────────┤
│ 1. Запит до БД:                    │
│    - status IN (new, in_progress)  │
│    - is_completed = false          │
│ 2. Підрахунок: COUNT(*)            │
│ 3. Повернути число або null        │
└──────────┬─────────────────────────┘
           │
           ▼
┌──────────────────────────────────────────┐
│ TaskResource::getNavigationBadgeColor()  │
├──────────────────────────────────────────┤
│ 1. Той самий запит до БД             │
│ 2. Match виразом визначити колір:    │
│    - 0     → null                    │
│    - < 5   → 'success'               │
│    - < 10  → 'warning'               │
│    - >= 10 → 'danger'                │
└──────────┬───────────────────────────────┘
           │
           ▼
┌────────────────────────┐
│ Відображення в UI:     │
│ 📋 Задачі [12] 🔴      │
└────────────────────────┘
```

## Приклади різних станів

### Стан 1: Немає активних задач
```
┌──────────────────┐
│ БД: 0 активних   │
└────────┬─────────┘
         │
         ▼
┌──────────────────┐
│ Badge: null      │
│ Color: null      │
└────────┬─────────┘
         │
         ▼
   📋 Задачі          <- Badge не відображається
```

### Стан 2: Мало задач (1-4)
```
┌──────────────────┐
│ БД: 3 активних   │
└────────┬─────────┘
         │
         ▼
┌──────────────────┐
│ Badge: "3"       │
│ Color: success   │
└────────┬─────────┘
         │
         ▼
   📋 Задачі [3] 🟢    <- Зелений badge
```

### Стан 3: Помірна кількість (5-9)
```
┌──────────────────┐
│ БД: 7 активних   │
└────────┬─────────┘
         │
         ▼
┌──────────────────┐
│ Badge: "7"       │
│ Color: warning   │
└────────┬─────────┘
         │
         ▼
   📋 Задачі [7] 🟡    <- Жовтий badge
```

### Стан 4: Багато задач (10+)
```
┌──────────────────┐
│ БД: 15 активних  │
└────────┬─────────┘
         │
         ▼
┌──────────────────┐
│ Badge: "15"      │
│ Color: danger    │
└────────┬─────────┘
         │
         ▼
   📋 Задачі [15] 🔴   <- Червоний badge
```

## Критерії відбору задач

```
┌─────────────────────────────────────────┐
│         Всі задачі в таблиці            │
├─────────────────────────────────────────┤
│                                         │
│  ✅ status = 'new'                      │
│  ✅ status = 'in_progress'              │
│  ❌ status = 'completed'                │
│  ❌ status = 'canceled'                 │
│  ❌ status = 'needs_clarification'      │
│  ❌ status = 'etap'                     │
│  ❌ status = 'archived'                 │
│  ❌ status = 'idea'                     │
│  ❌ status = 'other'                    │
│                                         │
├─────────────────────────────────────────┤
│           І обов'язково:                │
│       is_completed = false              │
└─────────────────────────────────────────┘
```

## Продуктивність

### Без кешування (поточна реалізація)
```
Кожен запит сторінки
       │
       ▼
2 SQL запити до БД
(badge + color)
       │
       ▼
~10-50ms затримка
```

### З кешуванням (рекомендація)
```
Перший запит
       │
       ▼
SQL запит + збереження в Cache (60 сек)
       │
       ▼
Наступні запити (протягом 60 сек)
       │
       ▼
Читання з Cache
       │
       ▼
~1-2ms затримка
```

## Розширення функціональності

### Варіант 1: Фільтр по користувачу
```php
Task::whereIn('status', [...])
    ->where('is_completed', false)
    ->where('user_id', auth()->id())  // ← додати
    ->count();
```

### Варіант 2: Окремі badge для статусів
```
📋 Задачі [3/5]
           ↑ ↑
     новий │ └─ в процесі
```

### Варіант 3: Tooltip з деталями
```
📋 Задачі [8] 🟡
       │
       └─► При наведенні:
           "3 нових, 5 в про��есі"
```

