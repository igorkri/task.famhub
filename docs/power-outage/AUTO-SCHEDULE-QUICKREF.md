# –®–≤–∏–¥–∫–∏–π –¥–æ–≤—ñ–¥–Ω–∏–∫ - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø—É—Å–∫ –≥—Ä–∞—Ñ—ñ–∫–∞ –≤—ñ–¥–∫–ª—é—á–µ–Ω—å

## üöÄ –®–≤–∏–¥–∫–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

### –ö—Ä–æ–∫ 1: –î–æ–¥–∞–π—Ç–µ –æ–¥–∏–Ω —Ä—è–¥–æ–∫ —É cron

```bash
crontab -e
```

–î–æ–¥–∞–π—Ç–µ (–∑–∞–º—ñ–Ω—ñ—Ç—å —à–ª—è—Ö –Ω–∞ –≤–∞—à):
```cron
* * * * * cd /home/igor/developer/task.famhub.local && php8.4 artisan schedule:run >> /dev/null 2>&1
```

**–¶–µ –≤—Å–µ!** Laravel –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç–∏–º–µ `power:fetch-schedule` –∫–æ–∂–Ω—ñ 10 —Ö–≤–∏–ª–∏–Ω.

---

## ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)
```bash
./scripts/check-power-schedule.sh
```

–°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å:
- ‚úÖ –ù–∞—è–≤–Ω—ñ—Å—Ç—å –∫–æ–º–∞–Ω–¥–∏
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è scheduler
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è cron
- ‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É
- ‚úÖ Imagick
- ‚úÖ Telegram
- ‚úÖ –¢–µ—Å—Ç–æ–≤–∏–π –∑–∞–ø—É—Å–∫
- ‚úÖ –û—Å—Ç–∞–Ω–Ω—ñ–π –∑–∞–ø–∏—Å –≤ –ë–î

### –ü–æ–∫–∞–∑–∞—Ç–∏ –∑–∞–ø–ª–∞–Ω–æ–≤–∞–Ω—ñ –∫–æ–º–∞–Ω–¥–∏
```bash
php artisan schedule:list
```

–í–∏–≤—ñ–¥:
```
*/10 *   * * *  php artisan power:fetch-schedule .... Next Due: –∑–∞ 5 —Ö–≤–∏–ª–∏–Ω
```

### –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≤—Ä—É—á–Ω—É
```bash
php artisan power:fetch-schedule
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π –≥—Ä–∞—Ñ—ñ–∫ —É –ë–î
```bash
php artisan tinker
>>> App\Models\PowerOutageSchedule::latest()->first()->fetched_at
```

---

## üìä –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

1. ‚è∞ **Cron** –∑–∞–ø—É—Å–∫–∞—î scheduler –∫–æ–∂–Ω—É —Ö–≤–∏–ª–∏–Ω—É
2. üîç **Scheduler** –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —è–∫—ñ –∫–æ–º–∞–Ω–¥–∏ —Ç—Ä–µ–±–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏
3. üì• **–ö–æ–∂–Ω—ñ 10 —Ö–≤** –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è `power:fetch-schedule`:
   - –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î HTML –∑ —Å–∞–π—Ç—É –î–¢–ï–ö
   - –ü–∞—Ä—Å–∏—Ç—å —Ç–∞–±–ª–∏—Ü—é
   - –Ø–∫—â–æ —î –∑–º—ñ–Ω–∏ ‚Üí –∑–±–µ—Ä—ñ–≥–∞—î –≤ –ë–î + –≥–µ–Ω–µ—Ä—É—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è + –Ω–∞–¥—Å–∏–ª–∞—î –≤ Telegram
   - –Ø–∫—â–æ –∑–º—ñ–Ω –Ω–µ–º–∞—î ‚Üí –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç—å

---

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `routes/console.php`:

```php
// –ö–æ–∂–Ω—ñ 10 —Ö–≤–∏–ª–∏–Ω (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
Schedule::command('power:fetch-schedule')->everyTenMinutes();

// –Ü–Ω—à—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏:
->everyFiveMinutes()    // –∫–æ–∂–Ω—ñ 5 —Ö–≤
->everyFifteenMinutes() // –∫–æ–∂–Ω—ñ 15 —Ö–≤
->everyThirtyMinutes()  // –∫–æ–∂–Ω—ñ 30 —Ö–≤
->hourly()              // —â–æ–≥–æ–¥–∏–Ω–∏
->dailyAt('08:00')      // —â–æ–¥–Ω—è –æ 08:00
```

---

## üêõ Troubleshooting

### –ö–æ–º–∞–Ω–¥–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è?

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ cron
sudo service cron status

# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏
tail -f storage/logs/laravel.log

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤—Ä—É—á–Ω—É –∑ –¥–µ—Ç–∞–ª—è–º–∏
php artisan power:fetch-schedule -v
```

### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É?

```bash
chmod -R 775 storage
chown -R www-data:www-data storage
```

---

## üìö –î–µ—Ç–∞–ª—å–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

üëâ [AUTO-SCHEDULE-SETUP.md](AUTO-SCHEDULE-SETUP.md) - –ü–æ–≤–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ Supervisor, systemd, –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥–æ–º

---

## ‚ö° Production Ready

–î–ª—è –≤–∏—Ä–æ–±–Ω–∏—á–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **Supervisor** –∞–±–æ **systemd timer** –∑–∞–º—ñ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ–≥–æ cron.

–î–∏–≤—ñ—Ç—å—Å—è –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é –≤ [AUTO-SCHEDULE-SETUP.md](AUTO-SCHEDULE-SETUP.md#–≤–∏—Ä–æ–±–Ω–∏—á–µ-—Å–µ—Ä–µ–¥–æ–≤–∏—â–µ-production)

